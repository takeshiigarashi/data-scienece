<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>

# 8.7 ２変数の関係

## 相関関係の解釈

- 正の相関 ... 一方が増えれば他方も増加するような関係
- 負の相関 ... 一方が増えれば他方が減少するような関係
- 無相関 ... 正の相関とも負の相関とも言えない
- 偽相関 ... 相関があるように見えるが、別の要因で相関があるように見えているだけの状態

## 共分散と相関係数

共分散( $S_{xy}$ )は、以下の式で得られる:

$$S_{xy}=\frac{1}{n}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})$$

共分散では偏差の積を取っている。正＊正なら正、負＊負も正になる、つまり、正の相関がある場合に正の値を取る。正＊負または負＊正は負になるため、負の相関がある場合に負の値を取る。

共分散を各変量の標準偏差の積で割り算することで、単位や標準偏差の影響を受けない値になる。これが相関係数になっている。

相関係数 $r_{xy}$:

$$r_{xy} = \frac{S_{xy}}{S_xS_y} = \frac{1}{nS_xS_y}\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})$$

相関係数は<u>共分散／標準偏差の積</u>になっている。

このように定義される相関係数は、正式には**ピアソンの積率相関係数**という。

相関係数の目安

- $r \leq 0.6$ : 負の相関が強い
- $-0.6 \leq r \leq -0.2$ : 負の相関がある程度みられる
- $-0.2 \leq r \leq 0.2$ : 相関はなさそう
- $0.2 \leq r \leq 0.6$ : 正の相関がある程度みられる
- $0.6 \leq r$ : 正の相関が強い

## スピアマンの順位相関

２変数の間に線形な関係が存在しないデータや、データの値の順位しか情報がない場合、ピアソンの積率相関は使えないが、**スピアマンの順位相関係数**を使うことができる。

ピアソンの積率相関は、例えば２変数が曲線のように相関している場合に使うことができない。スピアマンの順位相関係数は、単調増加や単調減少の傾向だけをみるため、曲線のような非線形な関係にも適用することができる。

スピアマンの順位相関係数 $\rho$:

$$\rho = 1 - \frac{6}{n(n^2-1)}\sum_{i=1}^{n}(x_i - y_i)^2$$

ここで、 $x_i$ , $y_i$ は、 $i$ 番目のデータにおけるそれぞれの変数の順位を表す。

- $\rho$ が1に近い : 2変数間で順位の正の関連付けが強い
- $\rho$ が0に近い : 2変数間で順位の関連付けがほぼない
- $\rho$ が-1に近い : 2変数間で順位の負の関連付けが強い

スピアマンの順位相関係数は、データを順位に変換した後、ピアソンの積率相関を適用することで計算できる。

